\chapter{Introduction}
\label{chap:introduction}
\pagenumbering{arabic}
This document defines a format for describing programs to
facilitate user source level debugging. This description
can be generated by compilers, assemblers and linkage
editors. 
It can be used by debuggers and other tools. 
The
debugging information format does not favor the design of any
compiler or debugger. 
Instead, the goal is to create a method
of communicating an accurate picture of the source program
to any debugger in a form that is extensible to different
languages while retaining compatibility.
  
The design of the
debugging information format is open-ended, allowing for
the addition of new debugging information to accommodate new
languages or debugger capabilities while remaining compatible
with other languages or different debuggers.

\section{Purpose and Scope}
The debugging information format described in this document is
designed to meet the symbolic, source-level debugging needs of
different languages in a unified fashion by requiring language
independent debugging information whenever possible.  
Aspects
of individual languages, such as \addtoindex{C++} virtual functions or
\addtoindex{Fortran} common 
\nolink{blocks}, are accommodated by creating attributes
that are used only for those languages. 
This document is
believed to cover most debugging information needs of 
\addtoindex{Ada},
\addtoindex{C}, \addtoindex{C++}, \addtoindex{COBOL}, 
and \addtoindex{Fortran}; it also covers the basic needs
of various other languages.

This document describes \addtoindex{DWARF Version 4},
the fourth generation
of debugging information based on the DWARF format. DWARF
Version 4 extends \addtoindex{DWARF Version 3}
in a compatible manner.

The intended audience for this document is the developers
of both producers and consumers of debugging information,
typically compilers, debuggers and other tools that need to
interpret a binary program in terms of its original source.


\section{Overview}

There are two major pieces to the description of the DWARF
format in this document. The first piece is the informational
content of the debugging entries. The second piece is the
way the debugging information is encoded and represented in
an object file.

The informational content is described in 
Sections \ref{chap:generaldescription} 
through
\ref{chap:otherdebugginginformation}. 
Section  \ref{chap:generaldescription}
describes the overall structure of the information
and attributes that is common to many or all of the different
debugging information entries. 
Sections \ref{chap:programscopeentries}, 
\ref{chap:dataobjectandobjectlistentries} and 
\ref{chap:typeentries} describe
the specific debugging information entries and how they
communicate the necessary information about the source program
to a debugger. 
Section \ref{chap:otherdebugginginformation} 
describes debugging information
contained outside of the debugging information entries. The
encoding of the DWARF information is presented in 
Section \ref{datarep:datarepresentation}.

This organization closely follows that used in the DWARF
Version 3 document. Except where needed to incorporate
new material or to correct errors, the 
\addtoindex{DWARF Version 3}
text is generally reused in this document with little or
no modification.

In the following sections, text in normal font describes
required aspects of the DWARF format.  Text in \textit{italics} is
explanatory or supplementary material, and not part of the
format definition itself. The several appendices consist only
of explanatory or supplementary material, and are not part
of the formal definition.
\section{Vendor Extensibility}

This document does not attempt to cover all interesting
languages or even to cover all of the interesting debugging
information needs for its primary target languages. 
Therefore,
the document provides vendors a way to define their own
debugging information tags, attributes, base type encodings,
location operations, language names, calling conventions and
call frame instructions by reserving a subset of the valid
values for these constructs for vendor specific additions
and defining related naming conventions. 
Vendors may also use
debugging information entries and attributes defined here in
new situations. 
Future versions of this document will not use
names or values reserved for vendor specific additions. 
All
names and values not reserved for vendor additions, however,
are reserved for future versions of this document.

\addtoindex{DWARF Version 4} is intended to be permissive rather than
prescriptive. 
Where this specification provides a means for
describing the source language, implementors are expected
to adhere to that specification. 
For language features that
are not supported, implementors may use existing attributes
in novel ways or add vendor-defined attributes. 
Implementors
who make extensions are strongly encouraged to design them
to be compatible with this specification in the absence of
those extensions.

The DWARF format is organized so that a consumer can skip over
data which it does not recognize. 
This may allow a consumer
to read and process files generated according to a later
version of this standard or which contain vendor extensions,
albeit possibly in a degraded manner.

\section{Changes from Version 4 to Version 5}
\addtoindexx{DWARF Version 5}
The following is a list of the major changes made to the DWARF Debugging Information
Format since Version 4 was published. The list is not meant to be exhaustive.
\begin{itemize}
\item TBD...
\end{itemize}

DWARF Version 5 is compatible with DWARF Version 4 except as follows:
\begin{itemize}
\item A location list entry (see Section \refersec{chap:locationlists}) with 
the address range (0, \doublequote{-1}) is defined as the new default location 
list entry.
\item In a string type (see Section \refersec{chap:stringtypeentries}, a \DWATbytesize{}
attribute is defined to always describe the size of the string type. (Previously
it described the size of the optional string length data field if the \DWATstringlength{}
attribute was present.)
\end{itemize}

\section{Changes from Version 3 to Version 4}
\addtoindexx{DWARF Version 4}
The following is a list of the major changes made to the DWARF Debugging Information
Format since Version 3 was published. The list is not meant to be exhaustive.
\begin{itemize}
\item Reformulate 
Section 2.6 (Location Descriptions) 
to better distinguish DWARF location descriptions, which
compute the location where a value is found (such as an address in memory or a register
name) from DWARF expressions, which compute a final value (such as an array bound).
\item Add support for bundled instructions on machine architectures where instructions do not
occupy a whole number of bytes.
\item Add a new attribute form for 
section offsets, \livelink{chap:DWFORMsecoffset}{DW\_FORM\_sec\_offset}, 
\addtoindexx{section offset}
to replace the use
of \livelink{chap:DWFORMdata4}{DW\_FORM\_data4} and \livelink{chap:DWFORMdata8}{DW\_FORM\_data8} for section offsets.
\item Add an attribute, \livelink{chap:DWATmainsubprogram}{DW\_AT\_main\_subprogram}, to identify the main subprogram of a
program.
\item Define default array lower bound values for each supported language.
\item Add a new technique using separate type units, type signatures and COMDAT sections to
improve compression and duplicate elimination of DWARF information.
\item Add support for new C++ language constructs, including rvalue references, generalized
constant expressions, Unicode character types and template aliases.
\item Clarify and generalize support for packed arrays and structures.
\item Add new line number table support to facilitate profile based compiler optimization.
\item Add additional support for template parameters in instantiations.
\item Add support for strongly typed enumerations in languages (such as C++) that have two
kinds of enumeration declarations.
\end{itemize}
\addtoindex{DWARF Version 4} is compatible with 
\addtoindex{DWARF Version 3} except as follows:
\begin{itemize}
\item DWARF attributes that use any of the new forms of attribute value representation (for
section offsets, flag compression, type signature references, and so on) cannot be read by
\addtoindex{DWARF Version 3}
consumers because the consumer will not know how to skip over the
unexpected form of data.
\item DWARF frame and line table sections include a additional fields that affect the location
and interpretation of other data in the section.
\end{itemize}

\section{Changes from Version 2 to Version 3}
\addtoindexx{DWARF Version 3}
The following is a list of the major differences between
Version 2 and Version 3 of the DWARF Debugging Information
Format. The list is not meant to be exhaustive.
\begin{itemize}
\item
Make provision for DWARF information files that are larger
than 4 GBytes.
\item
Allow attributes to refer to debugging information entries
in other shared libraries.
\item
Add support for \addtoindex{Fortran 90} modules as well as allocatable
array and pointer types.
\item
Add additional base types for \addtoindex{C} (as revised for 1999).
\item
Add support for \addtoindex{Java} and \addtoindex{COBOL}.
\item
Add namespace support for \addtoindex{C++}.
\item
Add an optional section for global type names (similar to
the global section for objects and functions).
\item
Adopt \addtoindex{UTF-8} as the preferred representation of program name strings.
\item
Add improved support for optimized code (discontiguous
scopes, end of prologue determination, multiple section
code generation).  
\item Improve the ability to eliminate
duplicate DWARF information during linking.  
\end{itemize}

\addtoindex{DWARF Version 3}
is compatible with 
\addtoindex{DWARF Version 2} except as follows:
\begin{itemize}
\item
Certain very large values of the initial length fields that
begin DWARF sections as well as certain structures are reserved
to act as escape codes for future extension; one such extension
is defined to increase the possible size of DWARF descriptions
(see Section \refersec{datarep:32bitand64bitdwarfformats}).
\item
References that use the attribute form 
\livelink{chap:DWFORMrefaddr}{DW\_FORM\_ref\_addr}
are specified to be four bytes in the DWARF 32-bit format and
eight bytes in the DWARF 64-bit format, while 
\addtoindex{DWARF Version 2} 
specifies that such references have the same size as an
address on the target system (see Sections 
\refersec{datarep:32bitand64bitdwarfformats} and 
\refersec{datarep:attributeencodings}).
\item
The return\_address\_register field in a Common Information
Entry record for call frame information is changed to unsigned
LEB representation (see Section 
\refersec{chap:structureofcallframeinformation}).
\end{itemize}

\section{Changes from Version 1 to Version 2}
\addtoindex{DWARF Version 2} 
describes the second generation of debugging
information based on the DWARF format. While 
\addtoindex{DWARF Version 2}
provides new debugging information not available in
Version 1, the primary focus of the changes for Version
2 is the representation of the information, rather than
the information content itself. The basic structure of
the Version 2 format remains as in Version 1: the debugging
information is represented as a series of debugging information
entries, each containing one or more attributes (name/value
pairs). The Version 2 representation, however, is much more
compact than the Version 1 representation. In some cases,
this greater density has been achieved at the expense of
additional complexity or greater difficulty in producing and
processing the DWARF information. The definers believe that the
reduction in I/O and in memory paging should more than make
up for any increase in processing time.  

The representation
of information changed from Version 1 to Version 2, so that
Version 2 DWARF information is not binary compatible with
Version 1 information. To make it easier for consumers to
support both Version 1 and Version 2 DWARF information, the
Version 2 information has been moved to a different object
file section, \dotdebuginfo{}.  

\textit{
A summary of the major changes made in 
\addtoindex{DWARF Version 2}
compared to the DWARF Version 1 may be found in the 
\addtoindex{DWARF Version 2}
document.
}

