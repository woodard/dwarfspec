\chapter{Debug Section Relationships (Informative)}
\label{app:debugsectionrelationshipsinformative}
DWARF information is organized into multiple program sections, 
each of which holds a particular kind of information. In some 
cases, information in one section refers to information in one 
or more of the others. These relationships are illustrated by 
the diagram and associated notes on the following pages.

\textit{This diagram does not distinguish between the normal
and split object section pairs (for example, \dotdebuginfo{} 
versus \dotdebuginfodwo).}

\clearpage
\begin{landscape}
\begin{figure}[H]
\scriptsize
\begin{tikzpicture}
    [sect/.style={rectangle, rounded corners=10pt, draw, fill=blue!15, 
        inner sep=.2cm, minimum width=4.0cm},
	 link/.style={rectangle,                       draw,
        inner sep=.2cm, minimum width=4.5cm}]

% The left column, first sections, then links, from top to bottom
%
\node(zsectara) at ( 0, 15.0) [sect] {\dotdebugaranges};
\node(zlinka)   at ( 0, 13.5) [link] {To compilation unit~~(a)};
\node(zsectinf) at ( 0,  7.5) [sect] {\begin{tabular}{c} 
									 \dotdebuginfo 
									 \end{tabular}};
\node(zlinkb)   at ( 0,  1.5) [link] {To compilation unit~~(b)};
\node(zsectpub) at ( 0,  0.0) [sect] {\begin{tabular}{c} 
									 \dotdebugpubnames \\ 
									 \dotdebugpubtypes 
									 \end{tabular}};

\draw[thick,-to reversed]		(zlinka) -- (zsectara);
\draw[thick,angle 90-] 			(zsectinf) -- (zlinka);
\draw[thick,-angle 90] 			(zlinkb) -- (zsectinf);
\draw[thick,to reversed-]		(zsectpub) -- (zlinkb);

% The middle column, similarly
%
\node(zsectfra) at (5, 15.0)  [sect] {\dotdebugframe};
\node(zlinkc)   at (5, 13.5)  [link] {To abbreviations~~(c)};
\node(zlinkd)   at (5, 12.1)  [link] {\DWFORMstrp{}~~(d)};
\node(zlinke)	at (5, 10.4)  [link] {\begin{tabular}{c}
									  \DWATstroffsetsbase \\
									  \DWFORMstrx{}~~~~~~~~~(e) \\
									  \end{tabular}};
\node(zlinkf)   at (5,  8.4)  [link] {\begin{tabular}{c}
									  \DWOPcallref{}~~~~~(f) \\
									  \DWFORMrefaddr
									  \end{tabular}};
\node(zlinki)   at (5,  6.7)  [link] {\DWATmacros{}~~(g)};
\node(zlinkj)   at (5,  5.4)  [link] {\DWATstmtlist{}~~(h)};
\node(zlinkh)   at (5,  3.9)  [link] {\begin{tabular}{c}
                                      \DWATranges{}~~~~(i) \\
                                      \DWATrangesbase
                                      \end{tabular}};
\node(zlinkg)   at (5,  2.4)  [link] {\DWATlocation{}, etc.~~(j)};
\node(zlinkk)	at (5,  0.5)  [link] {\begin{tabular}(c)
									  \DWATaddrbase    \\
									  \DWFORMaddrx \\
									  \DWOPaddrx \\
									  \DWOPconstx
									  \end{tabular} (k)};

% Links between left and center
%
\draw[thick,to reversed-]			(zsectinf) -- (zlinkc.west);
\draw[thick,to reversed-]			(zsectinf) -- (zlinkd.west);
\draw[thick,to reversed-]			(zsectinf) -- (zlinke.west);
\draw[<->,thick]					(zsectinf) -- (zlinkf.west);
\draw[thick,to reversed-]			(zsectinf) -- (zlinkg.west);
\draw[thick,to reversed-]			(zsectinf) -- (zlinkh.west);
\draw[thick,to reversed-]			(zsectinf) -- (zlinki.west);
\draw[thick,to reversed-]			(zsectinf) -- (zlinkj.west);
\draw[thick,to reversed-]			(zsectinf) -- (zlinkk.north west);

% The right column
%
\node(zsectabb)	at (10, 15.00) [sect] {\dotdebugabbrev};
\node(zsectstr)	at (10, 13.75) [sect] {\dotdebugstr};
\node(zlinkl)   at (10, 12.50) [link] {To strings~~(l)};
\node(zsectstx) at (10, 11.25) [sect] {\dotdebugstroffsets};
\node(zlinkm)   at (10,  9.50) [link] {\begin{tabular}{c}
                                      \DWMACROdefineindirectx \\
                                      \DWMACROundefindirectx \\
                                      (m)
                                      \end{tabular}};
\node(zsectmac)	at (10,  7.80) [sect] {\dotdebugmacro};
\node(zlinkn)   at (10,  6.40) [link] {\begin{tabular}{c}
                                      macroinfo header~~~~~~(n)\\
                                      \DWMACROstartfile
                                      \end{tabular}};
\node(zsectlin)	at (10,  5.00) [sect] {\dotdebugline};
\node(zsectran)	at (10,  3.85) [sect] {\dotdebugranges};
\node(zsectloc)	at (10,  2.70) [sect] {\dotdebugloc{}};
\node(zlinko)   at (10,  1.20) [link] {\begin{tabular}{c}
                                       \DWOPaddrx \\
                                       \DWOPconstx
                                       \end{tabular} (o)};
\node(zsectadx) at (10,  -0.25) [sect] {\dotdebugaddr{}};

\draw[thick,to reversed-]		(zsectstx) -- (zlinkl);
\draw[thick,-angle 90]			(zlinkl) -- (zsectstr);
\draw[thick,to reversed-]       (zsectmac) -- (zlinkm);
\draw[thick,-angle 90]          (zlinkm) -- (zsectstx);
\draw[thick,to reversed-]       (zsectmac) -- (zlinkn);
\draw[thick,-angle 90]          (zlinkn) -- (zsectlin);
\draw[thick,to reversed-]       (zsectloc) -- (zlinko);
\draw[thick,-angle 90]          (zlinko) -- (zsectadx);

% Links between center and right
%
\draw[thick,-angle 90]		(zlinkc.east) -- (zsectabb.west);
\draw[thick,-angle 90]		(zlinkd.east) -- (zsectstr.west);
\draw[thick,-angle 90]		(zlinke.east) -- (zsectstx.west);
\draw[thick,-angle 90]		(zlinkg.east) -- (zsectloc.west);
\draw[thick,-angle 90]		(zlinkh.east) -- (zsectran.west);
\draw[thick,-angle 90]		(zlinki.east) -- (zsectmac.west);
\draw[thick,-angle 90]		(zlinkj.east) -- (zsectlin.west);
\draw[thick,-angle 90]		(zlinkk.east) -- (zsectadx.west);

\node(zlinky)   at (15.5, 10.5) [link] {\begin{tabular}{c}
                                        \DWMACROdefineindirect \\
                                        \DWMACROundefindirect \\
                                        (p)
                                        \end{tabular}};
\node(zlinkz)   at (15.5,  6.0) [link] {\begin{tabular}{c}
                                        \DWMACROtransparentinclude \\
                                        (q)
                                        \end{tabular}};

\draw[thick,to reversed-]       (zsectmac.east) -- (zlinky);
\draw[thick,-angle 90]          (zlinky) -- (zsectstr.east);
\draw[<->,thick]				(zsectmac.east) -- (zlinkz);

\end{tikzpicture}
\vspace{5mm}
\caption{Debug section relationships}
\label{fig:debugsectionrelationships}
\end{figure}
\end{landscape}

\clearpage
\begin{center}
   \textbf{Notes}
\end{center}
\begin{enumerate}[(a)]  
\item  \dotdebugaranges{} to \dotdebuginfo \\
The \texttt{debug\_info\_offset} value in
the header is
the offset in the \dotdebuginfo{} section of the
corresponding compilation unit header (not the compilation
unit entry).

%b
\item \dotdebugpubnames{} and \dotdebugpubtypes{} to \dotdebuginfo \\
The \texttt{debug\_info\_offset} value in the header is the offset in the
\dotdebuginfo{} section of the 
corresponding compilation unit header (not
the compilation unit entry). Each pubname/pubtype unit has the offset (within
the corresponding compilation unit) of the applicable debugging
information entry.

%c
\item \dotdebuginfo{} to \dotdebugabbrev \\
The \texttt{debug\_abbrev\_offset} value in the header is the offset in the
\dotdebugabbrev{} 
section of the abbreviations for that compilation unit.

%d
\item  \dotdebuginfo{} to \dotdebugstr \\
Attribute values of class string may have form 
\DWFORMstrp, whose
value is the offset in the \dotdebugstr{}
section of the corresponding string.

%e
\item \dotdebugstroffsets{} to \dotdebugstroffsets \\
The value of the \DWATstroffsetsbase{} attribute in a
\DWTAGcompileunit{}, \DWTAGtypeunit{} or \DWTAGpartialunit{} 
DIE is the offset in the
\dotdebugstroffsets{} section of the 
\addtoindex{string offsets table}
for that unit.
In addition, attribute values of class string may have form 
\DWFORMstrx, whose value is an index into the
string offsets table.

%f
\item \dotdebuginfo{} to \dotdebuginfo \\
The operand of the \DWOPcallref{} 
DWARF expression operator is the
offset of a debugging information entry in the 
\dotdebuginfo{} section of another compilation.
Similarly for attribute operands that have use
\DWFORMrefaddr.

%g
\item \dotdebuginfo{} to \dotdebugmacro \\
An attribute value of class 
\livelink{chap:classmacptr}{macptr} (specifically form
\DWFORMsecoffset) is an 
offset within the 
\dotdebugmacro{} section
of the beginning of the macro information for the referencing unit.

%h
\item \dotdebuginfo{} to \dotdebugline \\
An attribute value of class 
\livelink{chap:classlineptr}{lineptr} (specifically form
\DWFORMsecoffset) 
is an offset in the 
\dotdebugline{} section of the
beginning of the line number information for the referencing unit.

%i
\needlines{5}
\item \dotdebuginfo{} to \dotdebugranges \\
An attribute value of class \livelink{chap:classrangelistptr}{rangelistptr} 
(specifically form
\DWFORMsecoffset) 
is an offset within the \dotdebugranges{} section of
a range list.

%j
\item \dotdebuginfo{} to \dotdebugloc \\
An attribute value of class \livelink{chap:classloclistptr}{loclistptr} 
(specifically form
\DWFORMsecoffset) 
is an offset within the \dotdebugloc{} 
section of a
\addtoindex{location list}.

%k
\item \dotdebuginfo{} to \dotdebugaddr \\
The value of the \DWATaddrbase{} attribute in the
\DWTAGcompileunit{}, \DWTAGtypeunit{} or \DWTAGpartialunit{} DIE is the
offset in the \dotdebugaddr{} section of the machine
addresses for that unit.
\DWFORMaddrx, \DWOPaddrx{} and \DWOPconstx{} contain
indices relative to that offset.

%l
\item \dotdebugstroffsets{} to \dotdebugstr \\
Entries in the string offsets table
are offsets to the corresponding string text in the 
\dotdebugstr{} section.

%m
\item \dotdebugmacro{} to \dotdebugstroffsets \\
The second operand of a 
\DWMACROdefineindirect{} or \DWMACROundefindirect{} macro information
entry is an index into the string table in the 
\dotdebugstr{} section.


%n
\item \dotdebugmacro{} to \dotdebugline \\
The second operand of 
\DWMACROstartfile{} refers to a file entry in the 
\dotdebugline{} section relative to the start 
of that section given in the macro information header.

%o
\item \dotdebugloc{} to \dotdebugaddr \\
\DWOPaddrx{} and \DWOPconstx{} operators that occur in the 
\dotdebugloc{} section refer indirectly to the 
\dotdebugaddr{} section by way of the 
\DWATaddrbase{} attribute in the associated \dotdebuginfo{} 
section. 

%p
\item \dotdebugmacro{} to \dotdebugstroffsets \\
The second operand of a 
\DWMACROdefineindirectx{} or \DWMACROundefindirectx{} 
macro information entry is an index
into the string offset table in the 
\dotdebugstroffsets{} section.

%q
\item \dotdebugmacro{} to \dotdebugmacro \\
The second operand of a 
\DWMACROtransparentinclude{} macro information
entry is an offset into another part of the 
\dotdebugmacro{} section to the header for the 
sequence to be transparently included.


\end{enumerate}
